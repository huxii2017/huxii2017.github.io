<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ROC Curves Analysis</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="../../css/github-plus.css" />
  <link rel="stylesheet" href="../../css/code-theme.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">ROC Curves Analysis</h1>
</header>
<h1 id="a-practical-tutorial-for-plotting-roc-curves-in-r-and-python">üìò A Practical Tutorial for Plotting ROC Curves in R and Python</h1>
<details open>
<summary>
<b>üóÇÔ∏è Table of Contents</b>
</summary>
<ol type="1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#download">Download &amp; Usage Guide</a></li>
<li><a href="#r-tutorial">Part I ‚Äî Tutorial for Plotting ROC Curves in R</a></li>
<li><a href="#python-tutorial">Part II ‚Äî Tutorial for Plotting ROC Curves in Python</a></li>
</ol>
</details>
<h2 id="introduction">Introduction to ROC Curve Analysis</h2>
<p><strong>Receiver Operating Characteristic (ROC) curve analysis</strong> is a fundamental method used to evaluate the performance of binary classification systems.<br />
It illustrates the trade-off between <strong>sensitivity (true positive rate)</strong> and <strong>specificity (1 ‚àí false positive rate)</strong> across various decision thresholds.</p>
<p>The <strong>Area Under the Curve (AUC)</strong> provides a single scalar value that quantifies overall performance ‚Äî<br />
with <em>AUC = 1.0</em> representing a perfect classifier and <em>AUC = 0.5</em> indicating no discriminative ability.</p>
<p>For more details, see the <a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">Wikipedia article on ROC analysis</a>.</p>
<hr />
<h2 id="download">üìÅ ROC Analysis Utilities ‚Äî Download &amp; Usage Guide</h2>
<p>This notebook demonstrates <strong>Receiver Operating Characteristic (ROC)</strong> curve analysis and visualization in both <strong>Python</strong> and <strong>R</strong> environments.<br />
Each implementation provides consistent visual styling and high-quality, publication-ready figures.</p>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 30%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Language</th>
<th style="text-align: left;">Script</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>R</strong></td>
<td style="text-align: left;"><a href="../../scripts/R/roc_utils.R">üì• <code>roc_utils.R</code></a></td>
<td style="text-align: left;">R version for ROC computation and plotting using <em>ggplot2</em> and <em>pROC</em>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>R</strong></td>
<td style="text-align: left;"><a href="../../scripts/R/combine_by_group.R">üì• <code>combine_by_group.R</code></a></td>
<td style="text-align: left;">Helper function for grouping and combining multi-panel ROC plots.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Python</strong></td>
<td style="text-align: left;"><a href="../../scripts/Python/roc_utils.py">üì• <code>roc_utils.py</code></a></td>
<td style="text-align: left;">Full-featured Python utility for ROC computation and visualization (AUC, CI, overlay &amp; faceted plots).</td>
</tr>
</tbody>
</table>
<blockquote>
<p>üí° <strong>Tip:</strong><br />
You can right-click and select <strong>‚ÄúSave link as‚Ä¶‚Äù</strong> to download any script to your local workspace.<br />
Both R and Python versions provide consistent plotting styles for reproducible, publication-quality figures. ‚Äî</p>
</blockquote>
<h2 id="r-tutorial">Part I. Tutorial for plotting ROC curves in R</h2>
<p>üìò <strong>1. Load the R Utility Functions</strong></p>
<p>This section loads the custom R functions for ROC analysis and visualization. </br> The first script (<code>roc_utils.R</code>) provides functions for computing and plotting ROC curves, while the second script (<code>combine_by_group.R</code>) enables automated multi-panel composition using patchwork.</p>
<blockquote>
<p>üí° Tip: You should see the functions <code>roc_auc_ci()</code>, <code>plot_roc_panels()</code>, and <code>combine_by_group()</code> listed in the output, confirming that the scripts were successfully loaded.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Source the two scripts</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;../../scripts/R/roc_utils.R&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;../../scripts/R/combine_by_group.R&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lsf.str</span>()</span></code></pre></div>
<pre><code>combine_by_group : function (data, group_col = &quot;Dataset&quot;, group_list = NULL, plot_func, plot_args = list(), 
    ncol = 2, title_main = &quot;Combined Plots&quot;, help = FALSE)  
plot_roc_overlay : function (infer_df = NULL, datasets = NULL, truth_col = &quot;true&quot;, score_col = &quot;score&quot;, 
    colors = NULL, line_width = 1.2, line_alpha = 0.9, title_main = &quot;ROC Curve Comparison&quot;, 
    x_label = &quot;Specificity&quot;, y_label = &quot;Sensitivity&quot;, base_font = 16, legend_position = &quot;right&quot;, 
    help = FALSE)  
plot_roc_panels : function (infer_df, datasets = c(&quot;Cohort 01&quot;, &quot;Cohort 02&quot;), truth_col = &quot;true&quot;, 
    score_col = &quot;score&quot;, colors = c(&quot;#F8766D&quot;), line_width = 1.2, line_alpha = 0.9, 
    title_main = &quot;ROC Curve Analysis&quot;, x_label = &quot;Specificity&quot;, y_label = &quot;Sensitivity&quot;, 
    show_auc_label = TRUE, auc_pos = c(0.35, 0.18), auc_digits = 3, ncol = 2, 
    base_font = 16, help = FALSE)  
roc_auc_ci : function (y_true = NULL, y_score = NULL, help = FALSE)  </code></pre>
<p>üìä <strong>2. Load Example Dataset (pROC::aSAH)</strong></p>
<p>To demonstrate the ROC analysis workflow, we use the built-in <strong>aSAH</strong> dataset from the pROC package.</br> This dataset contains clinical and biomarker data from patients with aneurysmal subarachnoid hemorrhage (aSAH).</br> It includes outcome labels (‚ÄúGood‚Äù or ‚ÄúPoor‚Äù) and quantitative predictors such as s100b and ndka.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aSAH)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aSAH)</span></code></pre></div>
<table class="dataframe">
<caption>
A data.frame: 6 √ó 7
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
gos6
</th>
<th scope="col">
outcome
</th>
<th scope="col">
gender
</th>
<th scope="col">
age
</th>
<th scope="col">
wfns
</th>
<th scope="col">
s100b
</th>
<th scope="col">
ndka
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;ord&gt;
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;fct&gt;
</th>
<th scope="col">
&lt;int&gt;
</th>
<th scope="col">
&lt;ord&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
29
</th>
<td>
5
</td>
<td>
Good
</td>
<td>
Female
</td>
<td>
42
</td>
<td>
1
</td>
<td>
0.13
</td>
<td>
3.01
</td>
</tr>
<tr>
<th scope="row">
30
</th>
<td>
5
</td>
<td>
Good
</td>
<td>
Female
</td>
<td>
37
</td>
<td>
1
</td>
<td>
0.14
</td>
<td>
8.54
</td>
</tr>
<tr>
<th scope="row">
31
</th>
<td>
5
</td>
<td>
Good
</td>
<td>
Female
</td>
<td>
42
</td>
<td>
1
</td>
<td>
0.10
</td>
<td>
8.09
</td>
</tr>
<tr>
<th scope="row">
32
</th>
<td>
5
</td>
<td>
Good
</td>
<td>
Female
</td>
<td>
27
</td>
<td>
1
</td>
<td>
0.04
</td>
<td>
10.42
</td>
</tr>
<tr>
<th scope="row">
33
</th>
<td>
1
</td>
<td>
Poor
</td>
<td>
Female
</td>
<td>
42
</td>
<td>
3
</td>
<td>
0.13
</td>
<td>
17.40
</td>
</tr>
<tr>
<th scope="row">
34
</th>
<td>
1
</td>
<td>
Poor
</td>
<td>
Male
</td>
<td>
48
</td>
<td>
2
</td>
<td>
0.10
</td>
<td>
12.75
</td>
</tr>
</tbody>
</table>
<p>üß© <strong>3. Prepare Data for ROC Analysis</strong></p>
<p>Next, we preprocess the dataset to create a suitable format for ROC visualization. </br> We convert the categorical outcome (Good / Poor) into a binary variable (true = 0/1) and reshape the biomarker columns (s100b, ndka) into a long format for multi-panel plotting.</p>
<blockquote>
<p>üí° After this transformation, each row now represents a single measurement‚Äìlabel pair. The column Dataset identifies the biomarker type, and score holds its corresponding numeric value.</p>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> aSAH <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">true =</span> <span class="fu">ifelse</span>(outcome <span class="sc">==</span> <span class="st">&quot;Poor&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(true, s100b, ndka) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(s100b, ndka),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">names_to =</span> <span class="st">&quot;Dataset&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demo)</span></code></pre></div>
<table class="dataframe">
<caption>
A tibble: 6 √ó 3
</caption>
<thead>
<tr>
<th scope="col">
true
</th>
<th scope="col">
Dataset
</th>
<th scope="col">
score
</th>
</tr>
<tr>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
s100b
</td>
<td>
0.13
</td>
</tr>
<tr>
<td>
0
</td>
<td>
ndka
</td>
<td>
3.01
</td>
</tr>
<tr>
<td>
0
</td>
<td>
s100b
</td>
<td>
0.14
</td>
</tr>
<tr>
<td>
0
</td>
<td>
ndka
</td>
<td>
8.54
</td>
</tr>
<tr>
<td>
0
</td>
<td>
s100b
</td>
<td>
0.10
</td>
</tr>
<tr>
<td>
0
</td>
<td>
ndka
</td>
<td>
8.09
</td>
</tr>
</tbody>
</table>
<p>üé® <strong>4. Plot ROC Curves for Multiple Biomarkers</strong></p>
<p>Now, we use the custom <strong>plot_roc_panels()</strong> function to visualize the ROC curves for multiple biomarkers side-by-side. Each panel corresponds to one dataset (s100b or ndka), displaying its ROC curve and AUC value.</p>
<blockquote>
<p>üí° Interpretation: </br> The ROC curve illustrates the trade-off between sensitivity and specificity. </br> The closer the curve follows the top-left corner, the better the biomarker‚Äôs classification performance.</p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">10</span>, <span class="at">repr.plot.height =</span> <span class="dv">5</span>, <span class="at">repr.plot.res =</span> <span class="dv">150</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_roc_panels</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">infer_df   =</span> demo,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">datasets   =</span> <span class="fu">c</span>(<span class="st">&quot;s100b&quot;</span>,<span class="st">&quot;ndka&quot;</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">truth_col  =</span> <span class="st">&quot;true&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">score_col  =</span> <span class="st">&quot;score&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">title_main =</span> <span class="st">&quot;ROC Curve Demo (aSAH)&quot;</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">base_font  =</span> <span class="dv">15</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<figure>
<img src="roc_plot_R_files/roc_plot_R_10_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<p>üßÆ <strong>5. Combine ROC Panels Automatically</strong></p>
<p>In this step, we demonstrate how to <strong>automatically combine</strong> multiple ROC panels into a unified figure layout. </br> The helper function <strong>combine_by_group()</strong> groups the input data by a specified column (here, ‚ÄúDataset‚Äù) and applies the chosen plotting function (<code>plot_roc_panels</code>) to each group, assembling the results into a single multi-panel plot.</p>
<blockquote>
<p>üí° Tip:</br> This modular design allows flexible customization ‚Äî you can easily plug in other plotting functions (e.g., for precision-recall or calibration curves) while preserving consistent formatting and layout.</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine ROC panels automatically</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">10</span>, <span class="at">repr.plot.height =</span> <span class="dv">5</span>, <span class="at">repr.plot.res =</span> <span class="dv">150</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>p_final <span class="ot">&lt;-</span> <span class="fu">combine_by_group</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> demo,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_col =</span> <span class="st">&quot;Dataset&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_func =</span> plot_roc_panels,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_args =</span> <span class="fu">list</span>(<span class="at">truth_col =</span> <span class="st">&quot;true&quot;</span>, <span class="at">score_col =</span> <span class="st">&quot;score&quot;</span>, <span class="at">base_font =</span> <span class="dv">15</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_main =</span> <span class="st">&quot;ROC Curve Demo (aSAH)&quot;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>p_final</span></code></pre></div>
<pre><code>Plotting group: s100b

Plotting group: ndka</code></pre>
<figure>
<img src="roc_plot_R_files/roc_plot_R_12_1.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<p>üîç <strong>6. Overlay ROC Curves in a Single Panel</strong></p>
<p>Finally, we can directly <strong>compare multiple ROC curves</strong> within a single plot using the <strong>plot_roc_overlay()</strong> function. This compact view allows for an intuitive visual comparison of model or biomarker performance by overlaying curves on the same axes.</p>
<blockquote>
<p>üí° Interpretation:</br> Each ROC curve represents the performance of one biomarker across all samples.</br> The AUC value in the legend quantifies the overall discriminative ability ‚Äî higher AUC indicates better separation between ‚Äúgood‚Äù and ‚Äúpoor‚Äù outcomes.</p>
</blockquote>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-panel comparison of ROC curves</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">4</span>, <span class="at">repr.plot.height =</span> <span class="dv">4</span>, <span class="at">repr.plot.res =</span><span class="dv">300</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p_overlay <span class="ot">&lt;-</span> <span class="fu">plot_roc_overlay</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">infer_df =</span> demo,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datasets =</span> <span class="fu">c</span>(<span class="st">&quot;s100b&quot;</span>, <span class="st">&quot;ndka&quot;</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">truth_col =</span> <span class="st">&quot;true&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">score_col =</span> <span class="st">&quot;score&quot;</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_main =</span> <span class="st">&quot;ROC Curve Comparison: s100b vs ndka&quot;</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_font =</span> <span class="dv">10</span>, <span class="at">legend_position=</span><span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">0.2</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_overlay)</span></code></pre></div>
<pre><code>Warning message:
‚Äú[1m[22mA numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
[36m‚Ñπ[39m Please use the `legend.position.inside` argument of `theme()` instead.‚Äù</code></pre>
<figure>
<img src="roc_plot_R_files/roc_plot_R_14_1.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<p>üß© <strong>7. Simulated Datasets for Demonstration</strong></p>
<p>To illustrate the visualization functions more clearly, we generate <strong>synthetic datasets</strong> with different levels of class separability.</br> Each dataset (Linear_High, Linear_Mid, Linear_Low) represents a binary classification problem where the two classes (0 and 1) have increasing overlap in their score distributions ‚Äî resulting in different AUC values.</p>
<blockquote>
<p>üí° Note: The greater the separation between the score distributions of the two classes, the higher the resulting AUC and the steeper the ROC curve.</p>
</blockquote>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_High&quot;</span> <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="st">&quot;Linear_High&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">true =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_Mid&quot;</span> <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="st">&quot;Linear_Mid&quot;</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">true =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="fl">1.5</span>, <span class="dv">1</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_Low&quot;</span> <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dataset =</span> <span class="st">&quot;Linear_Low&quot;</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">true =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(datasets)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demo)</span></code></pre></div>
<table class="dataframe">
<caption>
A data.frame: 6 √ó 3
</caption>
<thead>
<tr>
<th>
</th>
<th scope="col">
Dataset
</th>
<th scope="col">
true
</th>
<th scope="col">
score
</th>
</tr>
<tr>
<th>
</th>
<th scope="col">
&lt;chr&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
<th scope="col">
&lt;dbl&gt;
</th>
</tr>
</thead>
<tbody>
<tr>
<th scope="row">
1
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
0.6207567
</td>
</tr>
<tr>
<th scope="row">
2
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
0.0356414
</td>
</tr>
<tr>
<th scope="row">
3
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
0.7731545
</td>
</tr>
<tr>
<th scope="row">
4
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
1.2724891
</td>
</tr>
<tr>
<th scope="row">
5
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
0.3709754
</td>
</tr>
<tr>
<th scope="row">
6
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
-0.1628543
</td>
</tr>
</tbody>
</table>
<p>üé® <strong>8. Overlay ROC Curves for Synthetic Datasets</strong></p>
<p>Next, we visualize the three synthetic datasets on the <strong>same ROC plot</strong> to illustrate how curve shape and AUC value change with increasing class overlap. </br> The <strong>plot_roc_overlay()</strong> function is used again here, followed by a <strong>customized title style</strong> with ggtitle() and theme().</p>
<blockquote>
<p>üí° Tip:</br> This type of side-by-side comparison helps illustrate model separability intuitively ‚Äî </br> the <strong>‚ÄúLinear_High‚Äù</strong> dataset yields the steepest curve (best separability), while <strong>‚ÄúLinear_Low‚Äù</strong> produces the flattest ROC (poorest discrimination).</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-panel comparison of ROC curves</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">4</span>, <span class="at">repr.plot.height =</span> <span class="dv">3</span>, <span class="at">repr.plot.res =</span><span class="dv">300</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>p_overlay <span class="ot">&lt;-</span> <span class="fu">plot_roc_overlay</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">infer_df =</span> demo,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">datasets =</span> <span class="fu">c</span>(<span class="st">&quot;Linear_High&quot;</span>, <span class="st">&quot;Linear_Mid&quot;</span>, <span class="st">&quot;Linear_Low&quot;</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">truth_col =</span> <span class="st">&quot;true&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">score_col =</span> <span class="st">&quot;score&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_main =</span> <span class="st">&quot;ROC Curve Demo (High / Mid / Low Separability)&quot;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_font =</span> <span class="dv">8</span>, <span class="at">legend_position=</span><span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">0.2</span>), <span class="at">line_width=</span>.<span class="dv">8</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>p_overlay <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve Demo (High / Mid / Low Separability)&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<figure>
<img src="roc_plot_R_files/roc_plot_R_19_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<hr />
<h2 id="python-tutorial">Part II. Tutorial for plotting ROC curves in Python</h2>
<p>üêç <strong>1. Load Python Utility Functions</strong></p>
<p>To start, we import the custom plotting utilities defined in roc_utils.py. These functions include: * <strong>plot_roc_overlay_pub()</strong> ‚Äî Overlay multiple ROC curves in a single panel * <strong>plot_roc_panels_pub()</strong> ‚Äî Plot each ROC curve in a separate subplot (faceted layout) * <strong>roc_auc_ci()</strong> ‚Äî Compute AUC with 95% confidence intervals via bootstrapping</p>
<p>The following code adds the scripts directory to the Python path, reloads the module, and imports the functions.</p>
<blockquote>
<p>üí° Tip: Using <code>importlib.reload()</code> ensures that any edits made to <code>roc_utils.py</code> are immediately reflected without restarting the Jupyter kernel.</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sys.path.append(<span class="st">&quot;../../scripts/Python&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> importlib</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> roc_utils</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>importlib.<span class="bu">reload</span>(roc_utils)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> roc_utils <span class="im">import</span> plot_roc_overlay_pub,plot_roc_panels_pub,roc_auc_ci</span></code></pre></div>
<p>üìò <strong>2. View Function Documentation</strong></p>
<p>Once the module is imported, you can check the built-in documentation of any function by using Python‚Äôs <code>help()</code> command.</p>
<p>Here we inspect the docstring for <strong>roc_auc_ci()</strong>, which computes the ROC AUC and its 95% confidence interval using bootstrapping.</p>
<blockquote>
<p>üí° Tip: </br> All functions in roc_utils.py come with detailed docstrings ‚Äî use <code>help()</code> anytime to review available arguments, return values, and usage examples.</p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(roc_auc_ci)</span></code></pre></div>
<pre><code>Help on function roc_auc_ci in module roc_utils:

roc_auc_ci(
    y_true=None,
    y_score=None,
    help=False,
    n_bootstrap=2000,
    random_state=42
)
    Compute the ROC AUC value and its 95% confidence interval using bootstrapping.

    Args:
        y_true (array-like): True binary labels (0 or 1).
        y_score (array-like): Predicted continuous scores or probabilities.
        help (bool): If True, print this docstring and return None.
        n_bootstrap (int): Number of bootstrap resamples for CI estimation.
        random_state (int): Random seed for reproducibility.

    Returns:
        dict: {
            &quot;AUC&quot;: float,           # Calculated AUC value
            &quot;CI&quot;: (lower, mean, upper)
        }

    Example:
        &gt;&gt;&gt; result = roc_auc_ci([0, 1, 1, 0], [0.2, 0.8, 0.7, 0.3])
        &gt;&gt;&gt; print(result[&quot;AUC&quot;], result[&quot;CI&quot;])</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(plot_roc_overlay_pub)</span></code></pre></div>
<pre><code>Help on function plot_roc_overlay_pub in module roc_utils:

plot_roc_overlay_pub(
    infer_df,
    datasets,
    truth_col=&#39;true&#39;,
    score_col=&#39;score&#39;,
    colors=None,
    title_main=&#39;ROC Curve Comparison&#39;,
    base_font=22,
    title_font=None,
    line_width=2.5,
    alpha=1.0,
    figsize=(8, 8),
    legend_title=&#39;AUC&#39;,
    legend_font_delta=-7,
    legend_loc=(0.78, 0.2),
    fixedlocator=True
)
    Plot multiple ROC curves in one overlay figure with consistent styling.

    Args:
        infer_df (pd.DataFrame): Data containing &#39;Dataset&#39;, true, and score columns.
        datasets (list): Names of datasets to include in the overlay.
        truth_col (str): Column name for true labels.
        score_col (str): Column name for predicted scores.
        colors (dict or None): Optional mapping {dataset: color}.
        title_main (str): Main title for the plot.
        base_font (int): Base font size for axes/labels.
        line_width (float): ROC line width.
        alpha (float): Line transparency.
        figsize (tuple): Figure size (width, height).
        legend_title (str): Title for legend block.
        legend_font_delta (int): Relative font size for legend text.
        legend_loc (tuple): Legend position anchor (x, y) in axis coordinates.
        fixedlocator (bool): If True, use fixed minor ticks between 0‚Äì1.

    Returns:
        (fig, ax): Matplotlib figure and axis objects.</code></pre>
<p>üß™ <strong>3. Generate Example Datasets</strong></p>
<p>Next, we create three synthetic datasets, including <strong>Linear_High</strong>, <strong>Linear_Mid</strong>, and <strong>Linear_Low</strong>, to simulate classification tasks with different degrees of separability between positive (1) and negative (0) samples. * Linear_High: High separability (well-separated classes) * Linear_Mid: Moderate separability * Linear_Low: Low separability (significant overlap)</p>
<p>Each dataset contains 300 samples (n = 300), half positive and half negative, and a simulated prediction score generated from Gaussian distributions with different mean shifts.</p>
<blockquote>
<p>üìä Output: </br> The combined DataFrame demo contains all three datasets with columns: * Dataset ‚Äì Dataset name * true ‚Äì Ground truth label (0 or 1) * score ‚Äì Predicted score (continuous value)</p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np, pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">2025</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> {</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_High&quot;</span>: pd.DataFrame({</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Dataset&quot;</span>: <span class="st">&quot;Linear_High&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;true&quot;</span>: np.repeat([<span class="dv">0</span>, <span class="dv">1</span>], n<span class="op">//</span><span class="dv">2</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;score&quot;</span>: np.concatenate([np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, n<span class="op">//</span><span class="dv">2</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                                np.random.normal(<span class="dv">3</span>, <span class="dv">1</span>, n<span class="op">//</span><span class="dv">2</span>)])</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_Mid&quot;</span>: pd.DataFrame({</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Dataset&quot;</span>: <span class="st">&quot;Linear_Mid&quot;</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;true&quot;</span>: np.repeat([<span class="dv">0</span>, <span class="dv">1</span>], n<span class="op">//</span><span class="dv">2</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;score&quot;</span>: np.concatenate([np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, n<span class="op">//</span><span class="dv">2</span>),</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                                np.random.normal(<span class="fl">1.5</span>, <span class="dv">1</span>, n<span class="op">//</span><span class="dv">2</span>)])</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_Low&quot;</span>: pd.DataFrame({</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Dataset&quot;</span>: <span class="st">&quot;Linear_Low&quot;</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;true&quot;</span>: np.repeat([<span class="dv">0</span>, <span class="dv">1</span>], n<span class="op">//</span><span class="dv">2</span>),</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;score&quot;</span>: np.concatenate([np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, n<span class="op">//</span><span class="dv">2</span>),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                                np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, n<span class="op">//</span><span class="dv">2</span>)])</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>demo <span class="op">=</span> pd.concat(datasets.values())</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>demo.head()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
Dataset
</th>
<th>
true
</th>
<th>
score
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
-0.092390
</td>
</tr>
<tr>
<th>
1
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
0.734286
</td>
</tr>
<tr>
<th>
2
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
-1.438882
</td>
</tr>
<tr>
<th>
3
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
-0.663422
</td>
</tr>
<tr>
<th>
4
</th>
<td>
Linear_High
</td>
<td>
0
</td>
<td>
-0.100728
</td>
</tr>
</tbody>
</table>
</div>
<p>üé® <strong>4. Plot ROC Curves in a Single Overlay Panel</strong></p>
<p>Now we visualize all three datasets together using <strong>plot_roc_overlay_pub()</strong>, which draws multiple ROC curves on the same plot and automatically displays each dataset‚Äôs <strong>AUC</strong> in the legend.</p>
<p>In this example: * Each dataset is color-coded using a custom palette. * The x-axis represents <strong>Specificity (%)</strong>, and the y-axis represents <strong>Sensitivity (%)</strong>. * The plot follows a publication-ready format with consistent tick marks, diagonal reference line, and outward-pointing axes.</p>
<blockquote>
<p>üß© Note:</br> The clearer the class separation, the higher the AUC value (closer to 1.0). The <strong>Linear_High</strong> dataset should exhibit the best ROC performance, while <strong>Linear_Low</strong> should appear closer to the diagonal line.</p>
</blockquote>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>custom_colors <span class="op">=</span> {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_High&quot;</span>: <span class="st">&quot;#E64B35&quot;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_Mid&quot;</span>: <span class="st">&quot;#4DD576&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear_Low&quot;</span>: <span class="st">&quot;#1C97CC&quot;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plot_roc_overlay_pub(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    infer_df<span class="op">=</span>demo,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    datasets<span class="op">=</span>[<span class="st">&quot;Linear_High&quot;</span>, <span class="st">&quot;Linear_Mid&quot;</span>, <span class="st">&quot;Linear_Low&quot;</span>],</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    title_main<span class="op">=</span><span class="st">&quot;ROC Curve Demo (High / Mid / Low Separability)&quot;</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    base_font<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    title_font<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    line_width<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">=</span>custom_colors,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<figure>
<img src="roc_plot_Python_files/roc_plot_Python_11_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<p>üß© <strong>6. Plot Faceted ROC Panels</strong></p>
<p>To visualize each dataset <strong>in its own subplot</strong>, we use <strong>plot_roc_panels_pub()</strong>, which arranges multiple ROC curves into a clean, publication-ready grid layout.</p>
<p>Each panel shows: * Its own <strong>ROC curve</strong> and <strong>AUC value</strong> * Axes styled with the same tick format and diagonal reference * Consistent scaling for easy comparison</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(plot_roc_panels_pub)</span></code></pre></div>
<pre><code>Help on function plot_roc_panels_pub in module roc_utils:

plot_roc_panels_pub(
    infer_df,
    datasets=None,
    truth_col=&#39;true&#39;,
    score_col=&#39;score&#39;,
    colors=None,
    title_main=&#39;ROC Curve Panels&#39;,
    base_font=20,
    title_font=None,
    line_width=2.0,
    alpha=1.0,
    ncol=3,
    panel_size=(5, 5),
    legend_title=&#39;AUC&#39;,
    legend_font_delta=-6,
    fixedlocator=True
)
    Plot multiple ROC curves in a faceted (multi-panel) layout.

    Each dataset is plotted in its own subplot with consistent
    styling (axes, ticks, legend placement, etc.), suitable for
    figure panels in publications.

    Args:
        infer_df (pd.DataFrame): Data containing [Dataset, truth, score].
        datasets (list or None): Dataset names to plot (default: all).
        truth_col (str): Column name for true labels.
        score_col (str): Column name for predicted scores.
        colors (dict): Optional {dataset: color} mapping.
        title_main (str): Global figure title.
        base_font (int): Font size for labels and titles.
        line_width (float): Width of ROC line.
        alpha (float): Transparency for ROC line.
        ncol (int): Number of subplot columns.
        panel_size (tuple): Each subplot size in inches (width, height).
        legend_title (str): Title for the legend.
        legend_font_delta (int): Relative font size adjustment for legend.
        fixedlocator (bool): Use fixed 0‚Äì1 minor tick range.

    Returns:
        (fig, axes): Matplotlib figure and axes array.</code></pre>
<blockquote>
<p>üìä Note:</br> * ncol controls the number of columns in the subplot grid. * <code>panel_size</code> defines the width and height (in inches) of each subplot. * The function automatically removes any empty subplot if the number of datasets doesn‚Äôt perfectly fill the grid.</p>
</blockquote>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig_panels, axes <span class="op">=</span> plot_roc_panels_pub(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    infer_df<span class="op">=</span>demo,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    datasets<span class="op">=</span>[<span class="st">&quot;Linear_High&quot;</span>, <span class="st">&quot;Linear_Mid&quot;</span>, <span class="st">&quot;Linear_Low&quot;</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">=</span>custom_colors,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    title_main<span class="op">=</span><span class="st">&quot;ROC Curve Panels (High / Mid / Low)&quot;</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    base_font<span class="op">=</span><span class="dv">18</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    ncol<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    panel_size<span class="op">=</span>(<span class="fl">4.5</span>, <span class="dv">5</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<figure>
<img src="roc_plot_Python_files/roc_plot_Python_15_0.png" alt="png" /><figcaption aria-hidden="true">png</figcaption>
</figure>
<hr />
<script type="text/javascript">
// @ts-nocheck

document.addEventListener("DOMContentLoaded", () => {
document.querySelectorAll("div.sourceCode").forEach(block => {
    // Create "Copy" button
    const button = document.createElement("button");
    button.className = "copy-btn";
    button.innerText = "Copy";
    block.prepend(button);

    // Get language name from <pre class="sourceCode bash">...
    const pre = block.querySelector("pre");
    const lang = (pre.className.match(/sourceCode\s+(\w+)/) || [])[1];
    if (lang) block.setAttribute("data-lang", lang);

    // Copy functionality
    button.addEventListener("click", async () => {
        const code = block.querySelector("code").innerText;
        try {
        await navigator.clipboard.writeText(code);
        button.innerText = "Copied!";
        button.style.background = "#d1f7c4";
        setTimeout(() => {
            button.innerText = "Copy";
            button.style.background = "#f6f8fa";
        }, 1800);
        } catch (err) {
        button.innerText = "Error";
        console.error("Copy failed:", err);
        }
    });
    });
});

/* ===== Responsive Image Auto Sizing ===== */
document.addEventListener("DOMContentLoaded", function() {
    document.querySelectorAll("img").forEach(img => {
    img.onload = () => {
        const ratio = img.naturalWidth / img.naturalHeight;

        // Ê†áÂáÜÂàÜÁ±ªÈÄªËæëÔºöÁ´ñÂõæÂ∞è„ÄÅÊ®™ÂõæÂ§ß
        if (ratio < 0.9) {
        img.classList.add("portrait");  // Á´ñÂõæ
        } else if (ratio > 1.5) {
        img.classList.add("landscape"); // ÂÆΩÂõæ
        } else {
        img.classList.add("square");    // ÊñπÂõæ
        }
    };
    });
});

/* ===== TOC style determination ===== */
document.addEventListener("DOMContentLoaded", function() {
    // ÊâæÂà∞ÂÜÖÂÆπ‰∏ª‰Ωì
    const content = document.querySelector("main.content");
    if (!content) return;

    // ÂàõÂª∫ TOC ÂÆπÂô®
    const toc = document.createElement("nav");
    toc.id = "auto-toc";
    toc.innerHTML = "<h3>üìë Contents</h3><ul></ul>";

    // Êää TOC ÊèíÂà∞ content ‰πãÂâç
    const container = document.createElement("div");
    container.className = "toc-container";
    content.parentNode.insertBefore(container, content);
    container.appendChild(toc);
    container.appendChild(content);

    // Êâ´ÊèèÊ†áÈ¢òÔºàÊîØÊåÅ h1-h3Ôºâ
    const headers = content.querySelectorAll("h1, h2, h3");
    const list = toc.querySelector("ul");

    headers.forEach(header => {
    const id = header.id || header.textContent.trim().toLowerCase().replace(/[^\w]+/g, "-");
    header.id = id; // Á°Æ‰øùÊúâ id

    const li = document.createElement("li");
    li.innerHTML = `<a href="#${id}">${header.textContent}</a>`;
    list.appendChild(li);
    });

    // Âπ≥ÊªëÊªöÂä®
    list.querySelectorAll("a").forEach(link => {
    link.addEventListener("click", e => {
        e.preventDefault();
        const target = document.querySelector(link.getAttribute("href"));
        if (target) {
        window.scrollTo({ top: target.offsetTop - 20, behavior: "smooth" });
        }
    });
    });

  // ÊªöÂä®È´ò‰∫ÆÂΩìÂâçÁ´†ËäÇ
    const links = list.querySelectorAll("a");
    const sections = Array.from(links).map(link => document.querySelector(link.getAttribute("href")));

    window.addEventListener("scroll", () => {
    const scrollPos = window.scrollY + 100;
    sections.forEach((sec, i) => {
        if (sec && sec.offsetTop <= scrollPos && sec.offsetTop + sec.offsetHeight > scrollPos) {
        links.forEach(l => l.classList.remove("active"));
        links[i].classList.add("active");
        }
    });
    });
});
</script>
</body>
</html>
